<p id="topic-content"><h1 id="jd0e2">Upgrading Contrail Networking using contrail-ansible Deployer</h1><sw-topic-details date="2020-06-08"> </sw-topic-details><sw-admonition name="note" style=""><strong class="title">Note</strong><p>This procedure can be used for Contrail Networking upgrades
to Contrail Networking Release 2003 or earlier.</p><p>If you are upgrading to Contrail Networking Release 2005 or
later using the Ansible deployer, see <a href="../installation/installing-contrail-ansible-ziu.html">How to Perform a Zero Impact Contrail Networking Upgrade using Ansible</a>.</p></sw-admonition><p>Use the following procedure to upgrade Contrail Networking using
contrail-ansible deployer.</p><p>The procedure supports incremental model and you can use it
to upgrade from Contrail Networking Release <var v-pre="">N-1</var> to <var v-pre="">N</var>.</p><p>Take snapshots of your current configurations
before you proceed with the upgrade process. For details, refer to <a href="../../concept/backup-using-json-50.html">How to Backup and Restore Contrail Databases in JSON Format</a>.</p><ol type="1"><li id="jd0e32" style="">Navigate to the directory where the <code class="filepath">contrail-ansible-deployer-&lt;xxxx&gt;.&lt;NN&gt;.tgz</code> was untarred.<p>See <a href="../configuration/deploy-cluster-contrail-command-instances-yml.html#sample_instances_yml">Sample instances.yml File</a>.</p><p><em>Example using Contrail Networking Release 2003</em>:</p><p><code class="inline" v-pre="">cd contrail-ansible-deployer-2003.33/contrail-ansible-deployer/config/</code></p><p><code class="inline" v-pre="">vi contrail-ansible-deployer-2003.33/contrail-ansible-deployer/config/instances.yaml</code></p><p>Sample <code class="filepath">instances.yaml</code> files
for various other deployments are available at the same directory.</p></li><li id="jd0e57" style="">Update <var v-pre="">CONTRAIL_VERSION</var> and <var v-pre="">CONTRAIL_CONTAINER_TAG</var> to the desired version tag in this <code class="filepath">instances.yml</code> file.<p>Access <var v-pre="">CONTRAIL_CONTAINER_TAG</var> located at <a href="https://www.juniper.net/documentation/en_US/contrail20/information-products/topic-collections/release-notes/readme-contrail-20.pdf">README Access to Contrail Networking Registry 20xx</a> <sw-icon iconsize="18" name="pdf"> </sw-icon>.</p><div class="sample" dir="ltr" id="jd0e77"><p>For example:</p><div class="output" dir="ltr"><sw-code><template v-pre=""><pre>CONTRAIL_VERSION = 2003.33<br/>CONTRAIL_CONTAINER_TAG = 2003.33</pre></template></sw-code></div></div></li><li id="jd0e84" style="">Run the following commands from <code class="filepath">contrail-ansible-deployer</code> directory.<ul><li style=""><p>For Contrail with OpenStack deployment:</p><p><code class="inline" v-pre="">cd contrail-ansible-deployer</code><br/><code class="inline" v-pre="">ansible-playbook -e orchestrator=openstack -i inventory/
playbooks/install_openstack.yml -v</code><br/><code class="inline" v-pre="">ansible-playbook -e orchestrator=openstack -i inventory/ playbooks/install_contrail.yml
-v</code></p></li><li style=""><p>For Contrail with Kubernetes deployment:</p><p><code class="inline" v-pre="">cd contrail-ansible-deployer</code><br/><code class="inline" v-pre="">ansible-playbook -e orchestrator=kubernetes -i inventory/
playbooks/install_k8s.yml -v</code><br/><code class="inline" v-pre="">ansible-playbook -e orchestrator=kubernetes -i inventory/ playbooks/install_contrail.yml
-v</code></p></li></ul></li></ol><p>The ansible playbook logs are available on the terminal during
execution. You can also access it at <code class="inline" v-pre="">/var/log/ansible.log</code>.</p><sw-prev-next> </sw-prev-next></p>