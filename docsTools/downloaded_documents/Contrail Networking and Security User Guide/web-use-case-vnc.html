<p id="topic-content"><h1 id="jd0e2">Example: Deploying a Multi-Tier Web Application</h1><sw-topic-details date="2019-01-30"> </sw-topic-details><h2 id="jd0e15">Multi-Tier Web Application Overview</h2><p>A common requirement for a cloud tenant is to create a tiered
web application in leased cloud space. The tenant enjoys the favorable
economics of a private IT infrastructure within a shared services
environment. The tenant seeks speedy setup and simplified operations. </p><p>The following example shows how to set up a simple tiered web
application using Contrail. The example has a web server that a user
accesses by means of a public floating IP address. The front-end web
server gets the content it serves to customers from information stored
in a SQL database server that resides on a back-end network. The web
server can communicate directly with the database server without going
through any gateways. The public (or client) can only communicate
to the web server on the front-end network. The client is not allowed
to communicate directly with any other parts of the infrastructure.
See <a href="web-use-case-vnc.html#tier-web">Figure 1</a>.</p><figure id="tier-web"><figcaption>Figure 1: Simple Tiered Web Use Case</figcaption><div class="graphic"><img alt="Simple Tiered Web Use Case" src="images/s041840.gif" style=""/></div></figure><h2 id="jd0e32">Example: Setting Up Virtual Networks for a Simple Tiered Web
Application</h2><p>This example provides basic steps for setting up a simple
multi-tier network application. Basic creation steps are provided,
along with links to the full explanation for each of the creation
steps. Refer to the links any time you need more information about
completing a step.</p><ol type="1"><li id="jd0e41" style="">Working with a system that has the Contrail software installed
and provisioned, create a project named <strong v-pre="">demo</strong>.<p>For more information; see <a href="creating-projects-vnc.html">Creating Projects in OpenStack for Configuring Tenants in Contrail</a>.</p></li><li id="jd0e51" style="">In the <strong v-pre="">demo</strong> project, create three virtual networks:<ol type="a"><li style=""><p>A network named <strong v-pre="">public</strong> with IP address <strong v-pre="">10.84.41.0/24</strong></p><p>This is a special use virtual network for floating IP addresses—
it is assigned an address block from the public floating address pool
that is assigned to each web server. The assigned block is the only
address block advertised outside of the data center to clients that
want to reach the web services provided.</p></li><li style=""><p>A network named <strong v-pre="">frontend</strong> with IP address <strong v-pre="">192.168.1.0/24</strong></p><p>This network is the location where the web server virtual machine
instances are launched and attached. The virtual machines are identified
with private addresses that have been assigned to this virtual network.</p></li><li style=""><p>A network named <strong v-pre="">backend</strong> with IP address <strong v-pre="">192.168.2.0/24</strong></p><p>This network is the location where the database server virtual
machines instances are launched and attached. The virtual machines
are identified with private addresses that have been assigned to this
virtual network.</p></li></ol><p>For more information; see <a href="creating-virtual-network-vnc.html">Creating a Virtual Network with OpenStack Contrail</a> or <a href="creating-virtual-network-juniper-vnc.html">Creating a Virtual Network with Juniper Networks Contrail</a>.</p></li><li id="jd0e94" style="">Create a floating IP pool named <strong v-pre="">public_pool </strong> for the <strong v-pre="">public</strong> network within the <strong v-pre="">demo</strong> project;
see <a href="web-use-case-vnc.html#floating-pool">Figure 2</a>.<figure id="floating-pool"><figcaption>Figure 2: Create Floating IP Pool</figcaption><div class="graphic"><img alt="Create Floating IP Pool" src="images/s041841.gif" style=""/></div></figure></li><li id="jd0e112" style="">Allocate the floating IP pool <strong v-pre="">public_pool </strong>to
the <strong v-pre="">demo</strong> project; see <a href="web-use-case-vnc.html#allo">Figure 3</a>.<figure id="allo"><figcaption>Figure 3: Allocate Floating IP</figcaption><div class="graphic"><img alt="Allocate Floating IP" src="images/s041842.gif" style=""/></div></figure></li><li id="jd0e127" style="">Verify that the floating IP pool has been allocated; see <strong v-pre="">Configure &gt; Networking &gt; Allocate Floating IPs.</strong></li><li id="jd0e132" style="">Create a policy that allows any host to talk to any host
using any IP address, protocol, and port, and apply this policy between
the <strong v-pre="">frontend</strong> network and the <strong v-pre="">backend</strong> network. <p>This now allows communication between the web servers in the
front-end network and the database servers in the back-end network. </p></li><li id="jd0e143" style="">Launch the virtual machine instances that represent the
web server and the database server.<sw-admonition name="note" style=""><strong class="title">Note</strong><p>Your installation might not include the virtual machines
needed for the web server and the database server. Contact your account
team if you need to download the VMs for this setup.</p></sw-admonition><p>On the <strong v-pre="">Instances</strong> tab for this project, select <strong v-pre="">Launch Instance</strong> and for each instance that you launch, complete
the fields to make the following associations:</p><ul><li style=""><p>Web server VM: select <strong v-pre="">frontend</strong> network and
the policy created to allow communication between <strong v-pre="">frontend</strong> and <strong v-pre="">backend</strong> networks. Apply the floating IP address pool
to the web server.</p></li><li style=""><p>Database server VM: select <strong v-pre="">backend</strong> network
and the policy created to allow communication between <strong v-pre="">frontend</strong> and <strong v-pre="">backend</strong> networks.</p></li></ul></li></ol><h2 id="jd0e182">Verifying the Multi-Tier Web Application</h2><p>Verify your web setup.</p><ul><li id="jd0e189" style="">To demonstrate this web application setup, go to the client
machine, open a browser, and navigate to the address in the <strong v-pre="">public</strong> network that is assigned to the web server in the <strong v-pre="">frontend</strong> network.<p>The result will display the Contrail interface with various
data populated, verifying that the web server is communicating with
the database server in the <strong v-pre="">backend</strong> network and retrieving
data.</p><p>The client machine only has access to the public IP address.
Attempts to browse to any of the addresses assigned to the <strong v-pre="">frontend</strong> network or to the <strong v-pre="">backend</strong> network should fail. </p></li></ul><h2 id="jd0e212">Sample Addressing Scheme for Simple Tiered Web Application</h2><p>Use the information in <a href="web-use-case-vnc.html#sample-address">Table 1</a> as a guide for addressing devices in the simple tiered web example.</p><sw-table><p class="SubTitle" id="sample-address">Table 1: Sample Addressing Scheme for Example</p><table cellspacing="0" style="border-top:thin solid black;" width="99%"><thead><tr valign="bottom"><th align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System Name</p></th><th align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>Address Allocation</p></th></tr></thead><tbody><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System001</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.100</p></td></tr><tr class="row-with-bg" valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System002</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.101</p></td></tr><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System003</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.102</p></td></tr><tr class="row-with-bg" valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System004</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.103</p></td></tr><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>System005</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.104</p></td></tr><tr class="row-with-bg" valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>MX80-1</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.253</p><p>10.84.45.1 (public connection)</p></td></tr><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>MX80-2</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.252</p><p>10.84.45.2 (public connection)</p></td></tr><tr class="row-with-bg" valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>EX4200</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.11.254</p><p>10.84.45.254 (public connection)</p><p>10.84.63.259 (public connection)</p></td></tr><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>frontend network</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>192.168.1.0/24</p></td></tr><tr class="row-with-bg" valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>backend network</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>192.168.2.0/24</p></td></tr><tr valign="top"><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>public network (floating address)</p></td><td align="left" style="border-bottom:thin solid black;text-align: left;padding-right: 10px;padding-left: 10px;"><p>10.84.41.0/24</p></td></tr></tbody></table></sw-table><h2 id="jd0e322">Sample Physical Topology for Simple Tiered Web Application</h2><p><a href="web-use-case-vnc.html#sample-topology">Figure 4</a> provides a guideline diagram
for the physical topology for the simple tiered web application example.</p><figure id="sample-topology"><figcaption>Figure 4: Sample Physical Topology for Simple
Tiered Web Application</figcaption><div class="graphic"><img alt="Sample Physical Topology for Simple
Tiered Web Application" src="images/s041844.gif" style=""/></div></figure><h2 id="jd0e334">Sample Physical Topology Addressing</h2><p><a href="web-use-case-vnc.html#sample-addressing">Figure 5</a> provides a guideline
diagram for addressing the physical topology for the simple tiered
web application example.</p><figure id="sample-addressing"><figcaption>Figure 5: Sample Physical Topology Addressing</figcaption><div class="graphic"><img alt="Sample Physical Topology Addressing" src="images/s041845.gif" style=""/></div></figure><sw-prev-next> </sw-prev-next></p>